<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>PI Adapter for BACnet data selection configuration </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="PI Adapter for BACnet data selection configuration ">
    <meta name="generator" content="docfx 2.56.2.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../V1/index.html" width="46">
                <img id="logo" src="../../V1/main/V1/images/atlas_icon.png" height="46" width="46" alt="OSIsoft Edge System"> 
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="PIAdapterforBACnetDataSelectionConfiguration1-1">
<h1 id="pi-adapter-for-bacnet-data-selection-configuration">PI Adapter for BACnet data selection configuration</h1>

<p>In addition to the data source configuration, you need to provide a data selection configuration to specify the data you want the BACnet adapter to collect from the data sources.</p>
<p>When you add a data source, the adapter discovers devices and objects specified in the configuration.</p>
<h2 id="bacnet-device-configuration">BACnet device configuration</h2>
<p>In data source discovery, device information for all discovered devices is retrieved by the BACnet adapter, which is subsequently available through the following REST endpoint using any configuration tool that can execute an HTTP GET command:</p>
<p><code>http://localhost:5590/api/v1/configuration/&lt;ComponentId&gt;/DeviceConfiguration/</code></p>
<p><strong>Note:</strong> The device configuration is generated by the adapter and only supports HTTP <code>GET</code> and <code>DELETE</code>.</p>
<p>You can use the device configuration to choose an appropriate <strong>DataCollectionMode</strong> when you configure data selection. The following is an example of a BACnet device configuration that contains one routed device:</p>
<pre><code class="lang-json">[
  {
    &quot;DeviceIP&quot;: &quot;10.12.8.64&quot;,
    &quot;DeviceId&quot;: 419,
    &quot;NetworkNumber&quot;: 20,
    &quot;MacAddress&quot;: &quot;ba:cb:00:5a:c4:16&quot;,
    &quot;MaxApduSupported&quot;: 480,
    &quot;SegmentationSupported&quot;: &quot;MaxSegmentation&quot;,
    &quot;ServicesSupported&quot;: [
      &quot;WhoIs&quot;,
      &quot;IAm&quot;,
      &quot;ReadProperty&quot;,
      &quot;ReadPropertyMultiple&quot;
    ]
  }
]
</code></pre><h3 id="rest-urls-device-configuration">REST URLs (device configuration)</h3>
<table>
<thead>
<tr>
<th>Relative URL</th>
<th>HTTP verb</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>api/v1/configuration/<em>ComponentId</em>/DeviceConfiguration</td>
<td><code>GET</code></td>
<td>Retrieves the BACnet device configuration.</td>
</tr>
<tr>
<td>api/v1/configuration/<em>ComponentId</em>/DeviceConfiguration</td>
<td><code>DELETE</code></td>
<td>Deletes the BACnet device configuration.</td>
</tr>
</tbody>
</table>
<h2 id="configure-bacnet-data-selection">Configure BACnet data selection</h2>
<p><strong>Note:</strong> You cannot modify BACnet data selection configurations manually. You must use the REST endpoints to add or edit the configuration.</p>
<p>Complete the following steps to configure the BACnet data selection:</p>
<ol>
<li>Use a text editor to create a file that contains a BACnet data selection in JSON format.<ul>
<li>For content structure, see <a href="#bacnet-data-selection-example">BACnet data selection example</a>.</li>
<li>For a table of all available parameters, see <a href="#bacnet-data-selection-parameters">BACnet data selection</a>.</li>
</ul>
</li>
<li>Save the file, for example as <code>DataSelection.json</code>.</li>
<li><p>Use any of the <a class="xref" href="../../V1/main/V1/Configuration/configuration-tools.html">Configuration tools</a> capable of making HTTP requests to run a <code>POST</code> command with the contents of that file to the following endpoint: <code>http://localhost:5590/api/v1/configuration/&lt;ComponentId&gt;/DataSelection/</code>.</p>
<p><strong>Note:</strong> The following example uses BACnet1 as the adapter component name. For more information on how to add a component, see <a class="xref" href="../../V1/main/V1/Configuration/system-components-configuration.html">System components configuration</a>.</p>
<p> <code>5590</code> is the default port number. If you selected a different port number, replace it with that value.</p>
<p> Example using <code>curl</code>:</p>
<p> <strong>Note:</strong> Run this command from the same directory where the file is located:</p>
<pre><code class="lang-bash">curl -d &quot;@DataSelection.json&quot; -H &quot;Content-Type: application/json&quot; -X PUT &quot;http://localhost:5590/api/v1/configuration/BACnet1/DataSelection&quot;
</code></pre></li>
</ol>
<h2 id="bacnet-data-selection-schema">BACnet data selection schema</h2>
<p>The full schema definition for the BACnet data selection configuration is in the <code>BACnet_DataSelection_schema.json</code> file located in one of the following folders:</p>
<p>Windows: <code>%Program Files%\OSIsoft\Adapters\BACnet\Schemas</code></p>
<p>Linux: <code>/opt/OSIsoft/Adapters/BACnet/Schemas</code></p>
<h2 id="bacnet-data-selection-parameters">BACnet data selection parameters</h2>
<p>The following parameters are available to configure BACnet data selection:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Selected</strong></td>
<td>Optional</td>
<td><code>boolean</code></td>
<td>Use this field to select or clear a measurement. To select an item, set to <code>true</code> and specify a <strong>ScheduleId</strong>. To remove an item, leave the field empty or set to <code>false</code>. If not configured, the default value is <code>false</code>.</td>
</tr>
<tr>
<td><strong>Name</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>Name of the data item collected from the data source. The default value is <code>null</code> and results in the <strong>StreamId</strong> value being used also as a <strong>Name</strong>.</td>
</tr>
<tr>
<td><strong>StreamId</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>The custom stream ID to create the streams. If not specified, the BACnet adapter will generate a default stream ID based on the measurement configuration. A properly configured custom stream ID follows these rules:<br><br>Is not case-sensitive.<br>Can contain spaces.<br>Cannot start with two underscores (&quot;__&quot;).<br>Can contain a maximum of 100 characters.<br>Cannot use the following characters:<br><code>/</code> <code>:</code> <code>?</code> <code>#</code> <code>[</code> <code>]</code> <code>@</code> <code>!</code> <code>$</code> <code>&amp;</code> <code>&#39;</code> <code>(</code> <code>)</code> <code>\</code> <code>*</code> <code>+</code> <code>,</code> <code>;</code> <code>=</code> <code>%</code> <code>&lt;</code> <code>&gt;</code> `</td>
</tr>
<tr>
<td><strong>DataFilterId</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>The ID of the data filter. If not specified, no data filtering occurs.</td>
</tr>
<tr>
<td><strong>DeviceIPAddress</strong></td>
<td>Required</td>
<td><code>string</code></td>
<td>Device IP address</td>
</tr>
<tr>
<td><strong>DeviceId</strong></td>
<td>Required</td>
<td><code>number</code></td>
<td>BACnet device instance number</td>
</tr>
<tr>
<td><strong>ObjectType</strong></td>
<td>Required</td>
<td><code>string</code></td>
<td>Any of the <a class="xref" href="../PI%20Adapter%20for%20BACnet%20overview/PI%20Adapter%20for%20BACnet%20principles%20of%20operation1-1.html#object-types-and-data-types">supported object types</a></td>
</tr>
<tr>
<td><strong>ObjectId</strong></td>
<td>Required</td>
<td><code>number</code></td>
<td>BACnet object instance number</td>
</tr>
<tr>
<td><strong>DataCollectionMode</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>Specifies the mode of data collection for the item. Must be one of <code>Poll</code>, <code>SubscribeCov</code>, or <code>SubscribeCovProperty</code>. Default value is <code>Poll</code>.<br><br>For more information, see <a class="xref" href="Data%20selection%20configuration/Change%20Of%20Value%20configuration1-1.html">COV (Change Of Value) configuration</a> and <a class="xref" href="Data%20selection%20configuration/Polled%20data%20stream%20configuration1-1.html">Polled data stream configuration</a>.</td>
</tr>
<tr>
<td><strong>CovIncrement</strong></td>
<td>Optional</td>
<td><code>number</code></td>
<td>For use only with <code>SubscribeCovProperty</code> in <strong>DataCollectionMode</strong>. Specifies the amount that the configured property must change in order for a new value to be sent by the device. If the value is empty, the COV increment to use is determined by the device. If set to <code>0</code>, any change in value will result in a new data value being sent.</td>
</tr>
<tr>
<td><strong>PropertyIdentifier</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>Specifies which property to collect from the BACnet object. If left empty, <code>PresentValue</code> is collected.</td>
</tr>
<tr>
<td><strong>ScheduleId</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>Specifies a schedule ID to which the data selection item is linked. This data item is collected on the scheduled interval if Selected is set to <code>true</code>.<br><br>For <strong>DataCollectionMode</strong>=<code>Poll</code>, this is the interval at which this property is requested from the device.<br><br>For <strong>DataCollectionMode</strong>=<code>SubscribeCov</code> or <code>SubscribeCovProperty</code>, this is the interval at which a re-subscription request is sent.<br><br>For more information on schedules, see <a class="xref" href="../../V1/main/V1/Configuration/schedules-configuration.html">Schedules configuration</a>.</td>
</tr>
</tbody>
</table>
<h2 id="bacnet-data-selection-example">BACnet data selection example</h2>
<p>The following is an example of a valid BACnet data selection configuration with different data collection modes. Since the last item has <strong>Selected</strong> set to <code>false</code>, data will not be collected for it.</p>
<pre><code class="lang-json">[
 {
    &quot;Selected&quot;: true,
    &quot;Name&quot;: &quot;10.12.112.40_14.AnalogInput90&quot;,
    &quot;StreamId&quot;: &quot;10.12.112.40_14.AnalogInput90&quot;,
    &quot;DeviceIPAddress&quot;: &quot;10.12.112.40&quot;,
    &quot;DeviceId&quot;: 14,
    &quot;ObjectType&quot;: &quot;AnalogInput&quot;,
    &quot;ObjectId&quot;: 90,
    &quot;DataCollectionMode&quot;: &quot;Poll&quot;,
    &quot;ScheduleId&quot;: &quot;Schedule1&quot;
  },
  {
    &quot;Selected&quot;: true,
    &quot;Name&quot;: &quot;10.12.112.40_14.AnalogInput95&quot;,
    &quot;StreamId&quot;: &quot;10.12.112.40_14.AnalogInput95&quot;,
    &quot;DeviceIPAddress&quot;: &quot;10.12.112.40&quot;,
    &quot;DeviceId&quot;: 14,
    &quot;ObjectType&quot;: &quot;AnalogInput&quot;,
    &quot;ObjectId&quot;: 95,
    &quot;DataCollectionMode&quot;: &quot;SubscribeCovProperty&quot;,
    &quot;PropertyIdentifier&quot;: &quot;PresentValue&quot;,
    &quot;CovIncrement&quot;: 0.5,
    &quot;ScheduleId&quot;: &quot;Schedule1&quot;
  },
  {
    &quot;Selected&quot;: false,
    &quot;Name&quot;: &quot;10.12.112.40_16.AnalogOutput70&quot;,
    &quot;StreamId&quot;: &quot;10.12.112.40_16.AnalogOutput70&quot;,
    &quot;DeviceIPAddress&quot;: &quot;10.12.112.40&quot;,
    &quot;DeviceId&quot;: 16,
    &quot;ObjectType&quot;: &quot;AnalogOutput&quot;,
    &quot;ObjectId&quot;: 70,
    &quot;DataCollectionMode&quot;: &quot;SubscribeCov&quot;,
    &quot;ScheduleId&quot;: &quot;Schedule2&quot;
  }
]
</code></pre><h2 id="rest-urls">REST URLs</h2>
<table>
<thead>
<tr>
<th>Relative URL</th>
<th>HTTP verb</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>api/v1/configuration/<em>ComponentId</em>/DataSelection</td>
<td><code>GET</code></td>
<td>Retrieves the BACnet data selection configuration.</td>
</tr>
<tr>
<td>api/v1/configuration/<em>ComponentId</em>/DataSelection</td>
<td><code>PUT</code></td>
<td>Configures or updates the BACnet data selection configuration.</td>
</tr>
<tr>
<td>api/v1/configuration/<em>ComponentId</em>/DataSelection</td>
<td><code>DELETE</code></td>
<td>Deletes the BACnet data selection configuration.</td>
</tr>
<tr>
<td>api/v1/configuration/<em>ComponentId</em>/DataSelection</td>
<td><code>PATCH</code></td>
<td>Allows partial updating of configured data selection items. <br><strong>Note:</strong> The request must be an array containing one or more data selection items. Each data selection item in the array must include its <strong>StreamId</strong>.</td>
</tr>
<tr>
<td>api/v1/configuration/<em>ComponentId</em>/DataSelection/<em>StreamId</em></td>
<td><code>PUT</code></td>
<td>Updates or creates a new data selection with the specified <strong>StreamId</strong>.</td>
</tr>
<tr>
<td>api/v1/configuration/<em>ComponentId</em>/DataSelection/<em>StreamId</em></td>
<td><code>DELETE</code></td>
<td>Deletes a specific data selection item of the BACnet data selection configuration.</td>
</tr>
</tbody>
</table>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/osisoft/PI-Adapter-BACnet-Docs/blob/adapter-doc-yml/V1.1/Configuration/PI Adapter for BACnet data selection configuration1-1.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span><a href="https://www.osisoft.com/copyright/">© 2019 - 2020 OSIsoft, LLC. All rights reserved.</a></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
